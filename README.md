# Anki Sync Server

åŸºäºå®˜æ–¹ Anki Python åº“çš„åŒæ­¥æœåŠ¡å™¨ï¼Œä¸“ä¸ºæœåŠ¡å™¨ç¯å¢ƒè®¾è®¡ã€‚

## ğŸ¯ åŠŸèƒ½ç‰¹ç‚¹

- âœ… **è½»é‡çº§** - åŸºäº Pythonï¼Œæ— éœ€ GUI ç»„ä»¶
- âœ… **ç¨³å®š** - ä½¿ç”¨å®˜æ–¹ Anki åº“ï¼Œå…¼å®¹æ€§å¥½
- âœ… **ç®€å•** - é…ç½®ç®€å•ï¼Œæ˜“äºéƒ¨ç½²
- âœ… **æŒä¹…åŒ–** - æ”¯æŒ Volume æŒ‚è½½ï¼Œæ•°æ®ä¸ä¸¢å¤±

## ğŸš€ å¿«é€Ÿéƒ¨ç½²åˆ° Railway

### 1. å‡†å¤‡ç¯å¢ƒå˜é‡

åœ¨ Railway é¡¹ç›®ä¸­è®¾ç½®ï¼ˆå¯é€‰ï¼‰ï¼š
- `ANKIWEB_USERNAME` - AnkiWeb è´¦å·ç”¨æˆ·å
- `ANKIWEB_PASSWORD` - AnkiWeb è´¦å·å¯†ç 

> **æ³¨æ„**ï¼šè¿™äº›ç¯å¢ƒå˜é‡æ˜¯å¯é€‰çš„ã€‚Anki Sync Server æœ¬èº«ä¸éœ€è¦å®ƒä»¬ï¼Œä½†å¦‚æœæ‚¨æƒ³å®ç°è‡ªåŠ¨åŒæ­¥åˆ° AnkiWeb çš„åŠŸèƒ½ï¼Œå¯ä»¥è®¾ç½®å®ƒä»¬ã€‚

### 2. æ·»åŠ  Volumeï¼ˆå¼ºçƒˆæ¨èï¼‰

åœ¨ Railway é¡¹ç›®è®¾ç½®ä¸­ï¼š
- **Mount Path**: `/data`
- **Size**: 1 GB

### 3. éƒ¨ç½²ä»£ç 

```bash
git clone <your-repo>
cd Anki_Server
git push
```

Railway ä¼šè‡ªåŠ¨æ£€æµ‹ Dockerfile å¹¶å¼€å§‹æ„å»ºã€‚

## ğŸ“¡ ä½¿ç”¨åŒæ­¥æœåŠ¡å™¨

éƒ¨ç½²å®Œæˆåï¼Œæ‚¨ä¼šå¾—åˆ°ä¸€ä¸ªç±»ä¼¼è¿™æ ·çš„ URLï¼š
```
https://your-app-name.railway.app
```

### åœ¨ Anki æ¡Œé¢å®¢æˆ·ç«¯é…ç½®

1. æ‰“å¼€ Anki
2. è¿›å…¥ **å·¥å…· (Tools)** â†’ **é™„åŠ ç»„ä»¶ (Add-ons)**
3. å®‰è£…åŒæ­¥æœåŠ¡å™¨é…ç½®æ’ä»¶ï¼Œæˆ–æ‰‹åŠ¨é…ç½®

**é…ç½®åŒæ­¥ URL**ï¼š
```
https://your-app-name.railway.app:8080
```

### æµ‹è¯•è¿æ¥

```bash
curl https://your-app-name.railway.app:8080/health
```

## ğŸ”§ æœ¬åœ°å¼€å‘

### ä½¿ç”¨ Docker

```bash
# æ„å»ºé•œåƒ
docker build -t anki-sync-server .

# è¿è¡Œå®¹å™¨
docker run -d \
  -p 8080:8080 \
  -v $(pwd)/data:/data \
  anki-sync-server
```

### æœ¬åœ°è¿è¡Œï¼ˆæ—  Dockerï¼‰

```bash
# å®‰è£…ä¾èµ–
pip install anki

# å¯åŠ¨æœåŠ¡å™¨
python -m anki.syncserver --host 0.0.0.0 --port 8080 --base ./data
```

## ğŸ“ ç›®å½•ç»“æ„

```
.
â”œâ”€â”€ Dockerfile              # Docker é•œåƒå®šä¹‰
â”œâ”€â”€ sync-server-start.sh   # å¯åŠ¨è„šæœ¬
â”œâ”€â”€ .dockerignore          # Docker å¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ .env.example           # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â””â”€â”€ README.md              # æœ¬æ–‡æ¡£
```

## ğŸŒ ç¯å¢ƒå˜é‡

| å˜é‡ | è¯´æ˜ | é»˜è®¤å€¼ | å¿…éœ€ |
|------|------|--------|------|
| `SYNC_HOST` | ç›‘å¬åœ°å€ | `0.0.0.0` | å¦ |
| `SYNC_PORT` | ç›‘å¬ç«¯å£ | `8080` | å¦ |
| `SYNC_BASE` | æ•°æ®ç›®å½• | `/data` | å¦ |
| `ANKIWEB_USERNAME` | AnkiWeb ç”¨æˆ·å | - | å¦* |
| `ANKIWEB_PASSWORD` | AnkiWeb å¯†ç  | - | å¦* |

*ä»…åœ¨éœ€è¦è‡ªåŠ¨åŒæ­¥åˆ° AnkiWeb æ—¶éœ€è¦

## ğŸ“Š Volume é…ç½®

ä¸ºäº†æŒä¹…åŒ–æ•°æ®ï¼Œ**å¼ºçƒˆæ¨è**é…ç½® Volumeï¼š

### Railway Volume è®¾ç½®

1. è¿›å…¥é¡¹ç›® **Settings**
2. æ‰¾åˆ° **Volumes** éƒ¨åˆ†
3. ç‚¹å‡» **+ New Volume**
4. è®¾ç½®ï¼š
   - **Mount Path**: `/data`
   - **Size**: 1 GB

### æ•°æ®å­˜å‚¨ç»“æ„

```
/data/
â””â”€â”€ collections/
    â””â”€â”€ <user-data>.anki2
```

## ğŸ” å¥åº·æ£€æŸ¥

```bash
# æ£€æŸ¥æœåŠ¡å™¨çŠ¶æ€
curl http://localhost:8080/health

# é¢„æœŸå“åº”
{"status": "ok"}
```

## ğŸ› æ•…éšœæ’é™¤

### æœåŠ¡å™¨æ— æ³•å¯åŠ¨

æŸ¥çœ‹ Railway æ—¥å¿—ï¼š
```
railway logs
```

### è¿æ¥è¢«æ‹’ç»

ç¡®ä¿ï¼š
1. Railway æœåŠ¡æ­£åœ¨è¿è¡Œ
2. Volume å·²æ­£ç¡®æŒ‚è½½
3. ç«¯å£ 8080 å·²æš´éœ²

### æ•°æ®ä¸¢å¤±

ç¡®ä¿å·²è®¾ç½® Volumeï¼Œå¹¶ä¸”æŒ‚è½½è·¯å¾„ä¸º `/data`

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [Anki å®˜æ–¹æ–‡æ¡£](https://docs.ankiweb.net/)
- [Anki Python API](https://github.com/ankitects/anki)
- [Railway æ–‡æ¡£](https://docs.railway.app/)

## ğŸ†š ä¸æ—§ç‰ˆæœ¬çš„åŒºåˆ«

| ç‰¹æ€§ | æ—§ç‰ˆ (GUI) | æ–°ç‰ˆ (Sync Server) |
|------|-----------|-------------------|
| åŸºç¡€é•œåƒ | Debian (1GB+) | Python Slim (200MB) |
| GUI ä¾èµ– | âœ… éœ€è¦ Qt, X11 | âŒ æ— éœ€ GUI |
| å¯åŠ¨æ—¶é—´ | ~60-75 ç§’ | ~5-10 ç§’ |
| å†…å­˜å ç”¨ | ~500MB | ~100MB |
| ç¨³å®šæ€§ | âš ï¸ GUI é—®é¢˜ | âœ… ä¸“ä¸ºæœåŠ¡å™¨è®¾è®¡ |
| é…ç½®å¤æ‚åº¦ | ğŸ”´ å¤æ‚ | ğŸŸ¢ ç®€å• |

## ğŸ“ è®¸å¯è¯

æœ¬é¡¹ç›®ä½¿ç”¨ MIT è®¸å¯è¯ã€‚Anki æœ¬èº«ä½¿ç”¨ AGPL è®¸å¯è¯ã€‚

## ğŸ™ è‡´è°¢

- [Anki](https://apps.ankiweb.net/) - å¼ºå¤§çš„è®°å¿†å¡ç‰‡è½¯ä»¶
- [Railway](https://railway.app/) - ç®€å•çš„éƒ¨ç½²å¹³å°
